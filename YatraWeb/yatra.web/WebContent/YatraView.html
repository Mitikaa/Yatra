<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
<meta charset="utf-8">
<title>Yatra: Plan a trip</title>
<style>
#right-panel {
	font-family: 'Roboto', 'sans-serif';
	line-height: 30px;
	padding-left: 10px;
	
	
}

#right-panel select, #right-panel input {
	font-size: 15px;
}

#right-panel select {
	width: 100%;
	
}

#right-panel i {
	font-size: 12px;
	
}

html, body {
	height: 100%;
	margin: 0;
	padding: 0;
	
}

#map {
	height: 100%;
	float: left;
	width: 70%;
	height: 100%;
}

#right-panel {
	margin: 20px;
	border-width: 2px;
	width: 20%;
	height: 400px;
	float: left;
	text-align: left;
	padding-top: 0;
	
}

#directions-panel {
	margin-top: 10px;
	background-color: #FFEE77;
	padding: 10px;
}
</style>
</head>
<body>




<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=1315153828529272";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

	<div id="map"></div>
	<div id="right-panel">
	<div class="fb-login-button" data-max-rows="1" data-size="medium" data-show-faces="false" data-auto-logout-link="false"></div><br/>
		<div>
		
		
		
			<b>Start:</b> <select id="start">
				<option value="chicago, il">Chicago</option>
				<option value="Halifax, NS">Halifax, NS</option>
				<option value="Boston, MA">Boston, MA</option>
				<option value="New York, NY">New York, NY</option>
				<option value="Miami, FL">Miami, FL</option>
			</select>
			 <br> <b>End:</b> <select id="end">
				<option value="tempe, az">Tempe</option>
				<option value="Vancouver, BC">Vancouver, BC</option>
				<option value="Seattle, WA">Seattle, WA</option>
				<option value="San Francisco, CA">San Francisco, CA</option>
				<option value="Los Angeles, CA">Los Angeles, CA</option>
			</select> 
			
			<br><b>Vehicle Model :</b> <select id="start">
				<option value="Dodge Dart">Dodge Dart</option>
				<option value="GMCCanyon 2WD">GMCCanyon 2WD</option>
				<option value="FORD Fusion">FORD Fusion</option>
				<option value="FORD Focus">FORD Focus</option>
				<option value="Honda Civic">Honda Civic</option>
				<option value="Honda Elantra">Honda Elantra</option>
				<option value="KIA Rio">KIA Rio</option>
				<option value="MINI Cooper S">MINI Cooper S</option>
				<option value="Toyota Prius">Toyota Prius</option>
				<option value="Mercedes-Benz GL550 4matic">Mercedes-Benz GL550 4matic</option>
				<option value="Mitsubishi Lancer">Mitsubishi Lancer</option>
				
				
				

			</select>
			<input type="submit" id="submit">
			 
			
			
			
			
			
			
			
			
		</div>
		<div id="JSONOBJECTDISPLAY"></div>
		<div id="directions-panel"></div>
	</div>
	<script src="scripts/jquery-3.1.1.min.js"></script>
	<script>
		function initMap() {
			var directionsService = new google.maps.DirectionsService;
			var directionsDisplay = new google.maps.DirectionsRenderer;
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom : 6,
				center : {
					lat : 41.85,
					lng : -87.65
				}
			});
			directionsDisplay.setMap(map);

			document.getElementById('submit').addEventListener(
					'click',
					function() {
						calculateAndDisplayRoute(directionsService,
								directionsDisplay);
					});
		}

		function calculateAndDisplayRoute(directionsService, directionsDisplay) {
			var waypts = [];
			var start = document.getElementById('start').value;
			var end = document.getElementById('end').value;
			var datadString = 'start=' + encodeURIComponent(start) + '&'
					+ 'end=' + encodeURIComponent(end);

			$.ajax({
				type : "POST",
				url : "controller",
				data : datadString,
				dataType : "text",

				//if received a response from the server
				success : function(data, textStatus, jqXHR) {
					window.alert(data);
					var jsonResult = JSON.stringify(eval("(" + data + ")"));
					var jsonObj = JSON.parse(jsonResult);
					try {
						$.each(jsonObj, function(i, item) {
							waypts.push({
								location : new google.maps.LatLng(
										item.latitude, item.longitude),
								stopover : true
							});
						});
					} catch (e) {
						window.alert(e);
					}
					DisplayDirections(directionsService, directionsDisplay,
							waypts)
					//$("#error").html("<div><b>success!</b></div>"+data);
				},

				//If there was no resonse from the server
				error : function(data, textStatus, errorThrown) {
					//console.log("Something really bad happened " + textStatus);
					console.log("Something really bad happened " + data);

					$("#error").html(errorThrown + "\n" + textStatus);
				}
			});
		}

		function DisplayDirections(directionsService, directionsDisplay, waypts) {
			directionsService.route({
				origin : document.getElementById('start').value,
				destination : document.getElementById('end').value,
				waypoints : waypts,
				optimizeWaypoints : true,
				travelMode : 'DRIVING'
			}, function(response, status) {
				if (status === 'OK') {
					directionsDisplay.setDirections(response);
					var route = response.routes[0];
					var summaryPanel = document
							.getElementById('directions-panel');
					summaryPanel.innerHTML = '';
					// For each route, display summary information.
					for (var i = 0; i < route.legs.length; i++) {
						var routeSegment = i + 1;
						summaryPanel.innerHTML += '<b>Route Segment: '
								+ routeSegment + '</b><br>';
						summaryPanel.innerHTML += route.legs[i].start_address
								+ ' to ';
						summaryPanel.innerHTML += route.legs[i].end_address
								+ '<br>';
						summaryPanel.innerHTML += route.legs[i].distance.text
								+ '<br><br>';
					}
				} else {
					window.alert('Directions request failed due to ' + status);
				}
			});
		}
	</script>
	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDcyhQ0CcjBHzvoDvJlMJz96l8EvRzMN2o&callback=initMap">
		
	</script>
	
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '1315153828529272',
        xfbml      : true,
        version    : 'v2.6'
      });
    };
</script>

</body>
</html>